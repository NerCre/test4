<!DOCTYPE html>
<!--
  命をツナゲル - MVP
  このページは安全課向けに救急搬送時の職員情報確認を支援するアプリです。
  端末は縦向き利用を想定し、シンプルな画面遷移で必要な情報に素早くアクセスできます。
  全ての操作はオフラインで完結し、データは端末内に暗号化して保存されます。
-->
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>命をツナゲル</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app" class="app">
    <!-- Top bar, hidden on home -->
    <header id="topbar" class="topbar" aria-label="操作バー">
      <button id="btnBack" class="icon-btn" type="button" aria-label="戻る">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15.5 5.5 9 12l6.5 6.5-1.4 1.4L6.2 12l7.9-7.9 1.4 1.4z"/></svg>
        <span>戻る</span>
      </button>
      <div class="topbar-title">命をツナゲル</div>
      <button id="btnHome" class="icon-btn" type="button" aria-label="ホーム">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
        <span>ホーム</span>
      </button>
    </header>
    <main class="main">
      <!-- Home View -->
      <section id="view-home" class="view active" aria-label="ホーム">
        <div class="hero">
          <img src="ツナゲルちゃん.png" alt="ツナゲルちゃん" class="mascot-img" />
          <h1 class="app-title">命をツナゲル</h1>
          <p class="tagline">安全課向け救急搬送支援アプリ</p>
        </div>
        <div class="card">
          <div class="card-title">職員ID入力</div>
          <label class="field">
            <span>SMSから届いた内容を貼り付け</span>
            <textarea id="idInput" rows="3" placeholder="例：ID:A-01927\n氏名:山田 太郎\n状況:◯◯" autocapitalize="off"></textarea>
          </label>
          <button id="btnSearch" class="btn btn-primary" type="button">照合する</button>
          <p class="small">※ IDを含む本文をそのまま貼り付けると自動でIDを抽出します。</p>
        </div>
        <div class="home-footer">
          <button id="btnAdmin" class="link-btn" type="button" aria-label="マスタ設定">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19.14,12.94c0.04-0.31 0.06-0.63 0.06-0.94 0-0.31-0.02-0.63-0.06-0.94l2.03-1.58c0.18-0.14 0.23-0.41 0.12-0.61l-1.92-3.32c-0.11-0.2-0.35-0.28-0.56-0.2l-2.39 0.96c-0.5-0.38-1.04-0.7-1.63-0.94L14.4,2.5C14.37,2.22 14.13,2 13.85,2h-3.7c-0.28,0-0.52,0.22-0.55,0.5L9.24,5.04c-0.59,0.24-1.13,0.56-1.63,0.94L5.22,5.02c-0.21-0.08-0.45,0-0.56,0.2L2.74,8.54c-0.11,0.2-0.06,0.46,0.12,0.61l2.03,1.58C4.85,11.04 4.83,11.36 4.83,11.67c0,0.31 0.02,0.63 0.06,0.94L2.86,14.19c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.11,0.2 0.35,0.28 0.56,0.2l2.39-0.96c0.5,0.38 1.04,0.7 1.63,0.94l0.36,2.54c0.03,0.28 0.27,0.5 0.55,0.5h3.7c0.28,0 0.52-0.22 0.55-0.5l0.36-2.54c0.59-0.24 1.13-0.56 1.63-0.94l2.39 0.96c0.21,0.08 0.45,0 0.56-0.2l1.92-3.32c0.11-0.2 0.06-0.46-0.12-0.61L19.14,12.94z M12,15.5c-1.93,0-3.5-1.57-3.5-3.5S10.07,8.5,12,8.5s3.5,1.57,3.5,3.5S13.93,15.5,12,15.5z"/></svg>
            <span>マスタ設定</span>
          </button>
          <p class="small-note">※ このアプリはスマホ縦向き利用を想定しています。</p>
        </div>
      </section>

      <!-- Result View -->
      <section id="view-result" class="view" aria-label="検索結果">
        <h2 class="view-title">職員情報</h2>
        <div id="resultCard" class="result-card"></div>
        <div class="actions">
          <button id="btnResultBack" class="btn btn-secondary" type="button">戻る</button>
        </div>
      </section>

      <!-- Admin Login / Setup View -->
      <section id="view-admin-gate" class="view" aria-label="管理画面ログイン">
        <h2>マスタ設定</h2>
        <div id="adminGate" class="admin-gate">
          <p class="small" id="adminGateDesc">パスワードで保護されています。</p>
          <!-- First time setup -->
          <div id="adminFirst" class="card hidden">
            <div class="card-title">初回設定</div>
            <label class="field"><span>新しいパスワード</span><input id="newPass1" type="password" autocomplete="new-password" /></label>
            <label class="field"><span>確認</span><input id="newPass2" type="password" autocomplete="new-password" /></label>
            <button id="btnSetPass" class="btn btn-primary" type="button">設定する</button>
          </div>
          <!-- Login form -->
          <div id="adminLogin" class="card hidden">
            <div class="card-title">ログイン</div>
            <label class="field"><span>パスワード</span><input id="loginPass" type="password" autocomplete="current-password" /></label>
            <button id="btnAdminLogin" class="btn btn-primary" type="button">ログイン</button>
            <p id="loginMsg" class="small"></p>
          </div>
        </div>
      </section>

      <!-- Admin Panel View -->
      <section id="view-admin-panel" class="view" aria-label="マスタ管理">
        <h2>職員マスタ管理</h2>
        <div class="admin-section">
          <h3>登録済み</h3>
          <div id="staffList" class="staff-list"></div>
        </div>
        <div class="admin-section">
          <h3 id="formTitle">新規追加</h3>
          <form id="staffForm" autocomplete="off">
            <label class="field"><span>ID</span><input id="formId" type="text" required /></label>
            <label class="field"><span>氏名</span><input id="formName" type="text" required /></label>
            <label class="field"><span>血液型</span><input id="formBlood" type="text" /></label>
            <label class="field"><span>既往歴</span><textarea id="formHistory" rows="2"></textarea></label>
            <label class="field"><span>薬剤情報</span><textarea id="formMedication" rows="2"></textarea></label>
            <label class="field"><span>アレルギー</span><input id="formAllergy" type="text" /></label>
            <label class="field"><span>かかりつけ医</span><input id="formDoctor" type="text" /></label>
            <label class="field"><span>緊急連絡先（続柄）</span><input id="formEmergencyRel" type="text" /></label>
            <label class="field"><span>緊急連絡先（電話番号）</span><input id="formEmergencyTel" type="tel" /></label>
            <div class="form-actions">
              <button id="btnSaveStaff" type="submit" class="btn btn-primary">保存</button>
              <button id="btnDeleteStaff" type="button" class="btn btn-secondary hidden">削除</button>
              <button id="btnCancelEdit" type="button" class="btn btn-secondary">キャンセル</button>
            </div>
          </form>
        </div>
      </section>
      <!-- Toast -->
      <div id="toast" class="toast" role="status" aria-live="polite"></div>
    </main>
  </div>
  <script src="script.js"></script>
</body>
</html>